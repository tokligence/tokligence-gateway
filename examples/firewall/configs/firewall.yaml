# Tokligence Gateway Firewall Configuration
#
# This file configures the Prompt Firewall functionality for protecting
# sensitive data and preventing security issues in LLM requests/responses.

# Enable or disable the firewall completely
enabled: true

# Firewall mode:
#   - monitor: Log violations but allow requests to proceed
#   - enforce: Block requests that violate firewall rules
#   - disabled: Disable firewall entirely
mode: monitor

# Input filters (applied to requests before sending to LLM)
input_filters:
  # Built-in PII regex filter
  - type: pii_regex
    name: input_pii_basic
    priority: 10
    enabled: true
    config:
      redact_enabled: false  # Set to true to automatically redact detected PII
      enabled_types:
        - EMAIL
        - PHONE
        - SSN
        - CREDIT_CARD
        - IP_ADDRESS

  # External HTTP filter (Presidio sidecar)
  - type: http
    name: presidio_input
    priority: 20
    enabled: false  # Enable if you have Presidio sidecar running
    config:
      endpoint: http://localhost:7317/v1/filter/input
      timeout_ms: 500
      on_error: allow  # allow|block|bypass

# Output filters (applied to LLM responses before returning to client)
output_filters:
  # Built-in PII regex filter for outputs
  - type: pii_regex
    name: output_pii_basic
    priority: 10
    enabled: true
    config:
      redact_enabled: true  # Redact PII in outputs
      enabled_types:
        - EMAIL
        - PHONE
        - SSN
        - CREDIT_CARD
        - API_KEY

  # External HTTP filter (Presidio sidecar)
  - type: http
    name: presidio_output
    priority: 20
    enabled: false  # Enable if you have Presidio sidecar running
    config:
      endpoint: http://localhost:7317/v1/filter/output
      timeout_ms: 500
      on_error: bypass  # Don't block if service is down

# Policy configuration
policies:
  # Automatically redact PII across all filters
  redact_pii: true

  # Block requests with more than this many PII entities
  max_pii_entities: 5

  # Block requests/responses containing these categories
  block_on_categories:
    - CRITICAL_PII
    - DATA_EXFILTRATION
