# Tokligence Gateway Firewall Configuration
#
# This file configures the Prompt Firewall functionality for protecting
# sensitive data and preventing security issues in LLM requests/responses.

[prompt_firewall]
# Enable or disable the firewall completely
enabled = true

# Firewall mode:
#   - disabled: Disable firewall entirely (default in code)
#   - redact: Detect PII, replace with tokens, restore in responses (RECOMMENDED for production)
#   - monitor: Log violations but allow requests to proceed (for testing)
#   - enforce: Block requests that violate firewall rules (strict mode)
mode = redact

# PII patterns configuration file
pii_patterns_file = config/pii_patterns.ini

# Enabled regions (comma-separated)
# Available: global, us, cn, eu, uk, ca, au, in, jp, de, fr, sg
pii_regions = global,us

# Block requests with more than this many PII entities
max_pii_entities = 5

# Log all firewall decisions
log_decisions = true

# Don't log actual PII values in production
log_pii_values = false

# Minimum confidence threshold
pii_min_confidence = 0.75

# Input filters (applied to requests before sending to LLM)
[firewall_input_filters]
# Built-in PII regex filter
filter_pii_regex_enabled = true
filter_pii_regex_priority = 10

# External HTTP filter (Presidio sidecar) - disabled by default
# Uncomment to enable after starting Presidio sidecar
# filter_presidio_enabled = false
# filter_presidio_priority = 20
# filter_presidio_endpoint = http://localhost:7317/v1/filter/input
# filter_presidio_timeout_ms = 500
# filter_presidio_on_error = allow

# Output filters (applied to LLM responses before returning to client)
[firewall_output_filters]
# Built-in PII regex filter for outputs
filter_pii_regex_enabled = true
filter_pii_regex_priority = 10

# External HTTP filter (Presidio sidecar) - disabled by default
# filter_presidio_enabled = false
# filter_presidio_priority = 20
# filter_presidio_endpoint = http://localhost:7317/v1/filter/output
# filter_presidio_timeout_ms = 500
# filter_presidio_on_error = bypass
