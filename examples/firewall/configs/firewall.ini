# Tokligence Gateway Firewall Configuration
#
# This file configures the Prompt Firewall functionality for protecting
# sensitive data and preventing security issues in LLM requests/responses.
#
# Sensitive Data (SD) includes: email, phone, SSN, credit card, API keys,
# passwords, private keys, crypto addresses, national IDs, etc.

[prompt_firewall]
# Enable or disable the firewall completely
enabled = true

# Firewall mode:
#   - disabled: Disable firewall entirely (default in code)
#   - redact: Detect SD, replace with tokens, restore in responses (RECOMMENDED)
#   - monitor: Log violations but allow requests to proceed (for testing)
#   - enforce: Block requests that violate firewall rules (strict mode)
mode = redact

# SD patterns configuration file
pii_patterns_file = config/pii_patterns.ini

# Enabled regions (comma-separated)
# Available: global, us, cn, eu, uk, ca, au, in, jp, de, fr, sg
pii_regions = global,us

# Block requests with more than this many SD entities
max_pii_entities = 5

# Log all firewall decisions
log_decisions = true

# Don't log actual sensitive values in production
log_pii_values = false

# Minimum confidence threshold
pii_min_confidence = 0.75

# Input filters (applied to requests before sending to LLM)
[firewall_input_filters]
# Built-in Sensitive Data regex filter
filter_sd_regex_enabled = true
filter_sd_regex_priority = 10

# External HTTP filter - disabled by default
# Can be used with Tokligence Guard, Presidio, or other scanning APIs
# filter_http_enabled = false
# filter_http_priority = 20
# filter_http_endpoint = http://localhost:7317/v1/filter/input
# filter_http_timeout_ms = 5000
# filter_http_on_error = allow
# filter_http_header_X-API-Key = tok_your_api_key_here

# Output filters (applied to LLM responses before returning to client)
[firewall_output_filters]
# Built-in Sensitive Data regex filter for outputs
filter_sd_regex_enabled = true
filter_sd_regex_priority = 10

# External HTTP filter - disabled by default
# filter_http_enabled = false
# filter_http_priority = 20
# filter_http_endpoint = http://localhost:7317/v1/filter/output
# filter_http_timeout_ms = 5000
# filter_http_on_error = bypass
