# Strict Enforcement Configuration
# This configuration actively blocks requests with critical PII

enabled: true
mode: enforce  # Block requests that violate rules

input_filters:
  # High-priority regex filter
  - type: pii_regex
    name: input_pii_strict
    priority: 5
    enabled: true
    config:
      redact_enabled: true
      enabled_types:
        - EMAIL
        - PHONE
        - SSN
        - CREDIT_CARD
        - US_PASSPORT
        - API_KEY

  # Presidio for advanced detection
  - type: http
    name: presidio_strict
    priority: 10
    enabled: true
    config:
      endpoint: http://localhost:7317/v1/filter/input
      timeout_ms: 1000
      on_error: block  # Block if service fails (fail-closed)

output_filters:
  # Always redact PII in outputs
  - type: pii_regex
    name: output_pii_strict
    priority: 5
    enabled: true
    config:
      redact_enabled: true
      enabled_types:
        - EMAIL
        - PHONE
        - SSN
        - CREDIT_CARD
        - API_KEY
        - IP_ADDRESS
        - PERSON

  - type: http
    name: presidio_output_strict
    priority: 10
    enabled: true
    config:
      endpoint: http://localhost:7317/v1/filter/output
      timeout_ms: 1000
      on_error: block

policies:
  redact_pii: true
  max_pii_entities: 2  # Very strict limit
  block_on_categories:
    - CRITICAL_PII
    - DATA_EXFILTRATION
    - PROMPT_INJECTION
