# PII Pattern Definitions for Tokligence Gateway Firewall
#
# This file defines regex patterns for detecting Personally Identifiable Information (PII)
# across different regions and countries.
#
# Format: Each pattern is defined with:
#   pii_pattern_<region>_<name>_type = TYPE
#   pii_pattern_<region>_<name>_pattern = REGEX
#   pii_pattern_<region>_<name>_mask = [MASK]
#   pii_pattern_<region>_<name>_confidence = 0.XX
#   pii_pattern_<region>_<name>_description = Description text
#
# References:
# - Microsoft Presidio: https://microsoft.github.io/presidio/supported_entities
# - Azure AI PII: https://learn.microsoft.com/en-us/azure/ai-services/language-service/personally-identifiable-information/concepts/entity-categories
# - ScrubaDub: https://scrubadub.readthedocs.io/en/stable/
# - Fortinet PII: https://www.fortinet.com/resources/cyberglossary/pii

# ==============================================================================
# Global/Universal Patterns (always enabled)
# ==============================================================================

[pii_global]
# Email addresses (RFC 5322 compliant)
email_type = EMAIL
email_pattern = \b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b
email_mask = [EMAIL]
email_confidence = 0.95
email_description = Standard email address format

# IP addresses (IPv4) - Note: may match version numbers (Go regexp doesn't support lookbehind)
ip_v4_type = IP_ADDRESS
ip_v4_pattern = \b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b
ip_v4_mask = [IP]
ip_v4_confidence = 0.75
ip_v4_description = IPv4 address (may have false positives on version numbers)

# IP addresses (IPv6)
ip_v6_type = IP_ADDRESS
ip_v6_pattern = \b(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}\b
ip_v6_mask = [IP]
ip_v6_confidence = 0.85
ip_v6_description = IPv6 address

# URLs
url_type = URL
url_pattern = \b(?:https?://|www\.)[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+(?:/[^\s]*)?\b
url_mask = [URL]
url_confidence = 0.90
url_description = Web URL

# Crypto - Bitcoin
crypto_btc_type = CRYPTO_ADDRESS
crypto_btc_pattern = \b[13][a-km-zA-HJ-NP-Z1-9]{25,34}\b
crypto_btc_mask = [CRYPTO]
crypto_btc_confidence = 0.75
crypto_btc_description = Bitcoin address

# Crypto - Ethereum
crypto_eth_type = CRYPTO_ADDRESS
crypto_eth_pattern = \b0x[a-fA-F0-9]{40}\b
crypto_eth_mask = [CRYPTO]
crypto_eth_confidence = 0.80
crypto_eth_description = Ethereum address

# API Keys - OpenAI
api_openai_type = API_KEY
api_openai_pattern = \bsk-[a-zA-Z0-9]{20,}\b
api_openai_mask = [API_KEY]
api_openai_confidence = 0.95
api_openai_description = OpenAI API key

# API Keys - Anthropic
api_anthropic_type = API_KEY
api_anthropic_pattern = \bsk-ant-[a-zA-Z0-9-]{20,}\b
api_anthropic_mask = [API_KEY]
api_anthropic_confidence = 0.95
api_anthropic_description = Anthropic API key

# API Keys - AWS
api_aws_type = API_KEY
api_aws_pattern = \b(?:AKIA|ASIA)[0-9A-Z]{16}\b
api_aws_mask = [API_KEY]
api_aws_confidence = 0.95
api_aws_description = AWS access key

# API Keys - GitHub
api_github_type = API_KEY
api_github_pattern = \bghp_[a-zA-Z0-9]{36,}\b
api_github_mask = [API_KEY]
api_github_confidence = 0.95
api_github_description = GitHub personal access token

# API Keys - Generic
api_generic_type = API_KEY
api_generic_pattern = \b(?:api[_-]?key|apikey|access[_-]?token)[_-]?[:=]\s*["\']?([a-zA-Z0-9_-]{20,})["\']?\b
api_generic_mask = [API_KEY]
api_generic_confidence = 0.70
api_generic_description = Generic API key

# ==============================================================================
# United States
# ==============================================================================

[pii_us]
# Social Security Number (SSN)
ssn_type = SSN
ssn_pattern = \b\d{3}-\d{2}-\d{4}\b
ssn_mask = [SSN]
ssn_confidence = 0.95
ssn_description = US Social Security Number (XXX-XX-XXXX)

# SSN without dashes
ssn_nodash_type = SSN
ssn_nodash_pattern = \b\d{9}\b
ssn_nodash_mask = [SSN]
ssn_nodash_confidence = 0.70
ssn_nodash_description = US SSN without dashes

# Phone numbers
phone_type = PHONE
phone_pattern = \b(\+?1[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b
phone_mask = [PHONE]
phone_confidence = 0.90
phone_description = US phone number

# Credit card (Visa, MC, Discover, Amex with variable formatting)
credit_card_type = CREDIT_CARD
credit_card_pattern = \b(?:(?:4\d{3}|5[1-5]\d{2}|6011)[-\s]?\d{4}[-\s]?\d{4}[-\s]?\d{4}|3[47]\d{2}[-\s]?\d{6}[-\s]?\d{5})\b
credit_card_mask = [CREDIT_CARD]
credit_card_confidence = 0.85
credit_card_description = Credit card number

# Driver's License
drivers_license_type = DRIVERS_LICENSE
drivers_license_pattern = \b[A-Z]{1,2}\d{5,8}\b
drivers_license_mask = [DL]
drivers_license_confidence = 0.65
drivers_license_description = US driver's license

# Passport
passport_type = PASSPORT
passport_pattern = \b[A-Z]\d{8}\b
passport_mask = [PASSPORT]
passport_confidence = 0.70
passport_description = US passport number

# ITIN
itin_type = ITIN
itin_pattern = \b9\d{2}-[78]\d-\d{4}\b
itin_mask = [ITIN]
itin_confidence = 0.90
itin_description = US ITIN

# ==============================================================================
# China (中国)
# ==============================================================================

[pii_cn]
# 身份证号 (Chinese National ID)
national_id_type = NATIONAL_ID
national_id_pattern = \b[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[0-9Xx]\b
national_id_mask = [身份证]
national_id_confidence = 0.95
national_id_description = 中国居民身份证号码 (18位)

# 手机号 (Mobile phone)
phone_mobile_type = PHONE
phone_mobile_pattern = \b1[3-9]\d{9}\b
phone_mobile_mask = [手机]
phone_mobile_confidence = 0.90
phone_mobile_description = 中国手机号码

# 固定电话 (Landline)
phone_landline_type = PHONE
phone_landline_pattern = \b0\d{2,3}-?\d{7,8}\b
phone_landline_mask = [电话]
phone_landline_confidence = 0.80
phone_landline_description = 中国固定电话

# 护照号 (Passport)
passport_type = PASSPORT
passport_pattern = \b[EG]\d{8}\b
passport_mask = [护照]
passport_confidence = 0.85
passport_description = 中国护照号码

# 统一社会信用代码
uscc_type = BUSINESS_ID
uscc_pattern = \b[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}\b
uscc_mask = [信用代码]
uscc_confidence = 0.90
uscc_description = 统一社会信用代码

# 银行卡号
bank_card_type = BANK_ACCOUNT
bank_card_pattern = \b[1-9]\d{15,18}\b
bank_card_mask = [银行卡]
bank_card_confidence = 0.70
bank_card_description = 中国银行卡号

# ==============================================================================
# European Union
# ==============================================================================

[pii_eu]
# IBAN
iban_type = BANK_ACCOUNT
iban_pattern = \b[A-Z]{2}\d{2}[A-Z0-9]{1,30}\b
iban_mask = [IBAN]
iban_confidence = 0.85
iban_description = EU IBAN

# VAT Number
vat_type = TAX_ID
vat_pattern = \b[A-Z]{2}\d{8,12}\b
vat_mask = [VAT]
vat_confidence = 0.75
vat_description = EU VAT number

# ==============================================================================
# United Kingdom
# ==============================================================================

[pii_uk]
# National Insurance Number
ni_type = NATIONAL_ID
ni_pattern = \b[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}\d{6}[A-D]{1}\b
ni_mask = [NI]
ni_confidence = 0.90
ni_description = UK National Insurance Number

# NHS Number
nhs_type = MEDICAL_ID
nhs_pattern = \b\d{3}[-\s]?\d{3}[-\s]?\d{4}\b
nhs_mask = [NHS]
nhs_confidence = 0.80
nhs_description = UK NHS number

# Phone
phone_type = PHONE
phone_pattern = \b(?:(?:\+44\s?|0)(?:\d{2}\s?\d{4}\s?\d{4}|\d{3}\s?\d{3}\s?\d{4}|\d{4}\s?\d{6}))\b
phone_mask = [PHONE]
phone_confidence = 0.85
phone_description = UK phone number

# ==============================================================================
# Canada
# ==============================================================================

[pii_ca]
# SIN
sin_type = NATIONAL_ID
sin_pattern = \b\d{3}[-\s]?\d{3}[-\s]?\d{3}\b
sin_mask = [SIN]
sin_confidence = 0.85
sin_description = Canadian SIN

# Phone
phone_type = PHONE
phone_pattern = \b(\+?1[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b
phone_mask = [PHONE]
phone_confidence = 0.85
phone_description = Canadian phone number

# ==============================================================================
# Australia
# ==============================================================================

[pii_au]
# TFN
tfn_type = TAX_ID
tfn_pattern = \b\d{3}[-\s]?\d{3}[-\s]?\d{3}\b
tfn_mask = [TFN]
tfn_confidence = 0.80
tfn_description = Australian TFN

# Medicare
medicare_type = MEDICAL_ID
medicare_pattern = \b\d{4}[-\s]?\d{5}[-\s]?\d{1}\b
medicare_mask = [MEDICARE]
medicare_confidence = 0.85
medicare_description = Australian Medicare number

# Phone
phone_type = PHONE
phone_pattern = \b(?:\+61\s?)?(?:\(0\d\)|0\d)[-\s]?\d{4}[-\s]?\d{4}\b
phone_mask = [PHONE]
phone_confidence = 0.85
phone_description = Australian phone number

# ==============================================================================
# India
# ==============================================================================

[pii_in]
# Aadhaar
aadhaar_type = NATIONAL_ID
aadhaar_pattern = \b\d{4}[-\s]?\d{4}[-\s]?\d{4}\b
aadhaar_mask = [AADHAAR]
aadhaar_confidence = 0.75
aadhaar_description = Indian Aadhaar number

# PAN
pan_type = TAX_ID
pan_pattern = \b[A-Z]{5}\d{4}[A-Z]{1}\b
pan_mask = [PAN]
pan_confidence = 0.90
pan_description = Indian PAN

# Phone
phone_type = PHONE
phone_pattern = \b(?:\+91\s?)?[6-9]\d{9}\b
phone_mask = [PHONE]
phone_confidence = 0.85
phone_description = Indian phone number

# ==============================================================================
# Japan
# ==============================================================================

[pii_jp]
# My Number
mynumber_type = NATIONAL_ID
mynumber_pattern = \b\d{4}[-\s]?\d{4}[-\s]?\d{4}\b
mynumber_mask = [マイナンバー]
mynumber_confidence = 0.75
mynumber_description = Japanese My Number

# Phone
phone_type = PHONE
phone_pattern = \b(?:\+81\s?)?(?:0\d{1,4}[-\s]?\d{1,4}[-\s]?\d{4})\b
phone_mask = [PHONE]
phone_confidence = 0.80
phone_description = Japanese phone number

# ==============================================================================
# Germany
# ==============================================================================

[pii_de]
# Tax ID
tax_id_type = TAX_ID
tax_id_pattern = \b\d{11}\b
tax_id_mask = [STEUER-ID]
tax_id_confidence = 0.70
tax_id_description = German tax ID

# Phone
phone_type = PHONE
phone_pattern = \b(?:\+49\s?)?(?:\(0\d{2,5}\)|0\d{2,5})[-\s]?\d{3,8}\b
phone_mask = [PHONE]
phone_confidence = 0.80
phone_description = German phone number

# ==============================================================================
# France
# ==============================================================================

[pii_fr]
# NIR (Social Security)
nir_type = NATIONAL_ID
nir_pattern = \b[12]\d{2}(0[1-9]|1[0-2])\d{2}\d{3}\d{3}\d{2}\b
nir_mask = [NIR]
nir_confidence = 0.85
nir_description = French social security number

# Phone
phone_type = PHONE
phone_pattern = \b(?:\+33\s?)?(?:0\d{1})[-\s]?\d{2}[-\s]?\d{2}[-\s]?\d{2}[-\s]?\d{2}\b
phone_mask = [PHONE]
phone_confidence = 0.85
phone_description = French phone number

# ==============================================================================
# Singapore
# ==============================================================================

[pii_sg]
# NRIC/FIN
nric_type = NATIONAL_ID
nric_pattern = \b[STFG]\d{7}[A-Z]\b
nric_mask = [NRIC]
nric_confidence = 0.90
nric_description = Singapore NRIC/FIN

# Phone (allow optional spaces in +65 format)
phone_type = PHONE
phone_pattern = \b(?:\+65\s?|65)?[689]\d{7}\b
phone_mask = [PHONE]
phone_confidence = 0.90
phone_description = Singapore phone number

# ==============================================================================
# Configuration
# ==============================================================================

[pii_config]
# Default enabled regions (comma-separated)
# Available: global, us, cn, eu, uk, ca, au, in, jp, de, fr, sg
default_regions = global,us,cn

# Default enabled types (comma-separated, optional)
# If specified, only these types will be loaded regardless of region
# Leave empty to load all types from enabled regions
default_types =

# Minimum confidence threshold (0.0-1.0)
# Patterns below this threshold will be ignored
min_confidence = 0.70
