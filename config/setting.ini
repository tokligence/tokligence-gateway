# Tokligence Gateway global settings (base configuration)
#
# ============================================================================
# Configuration Hierarchy (priority from high to low):
# ============================================================================
# 1. Environment variables (e.g., TOKLIGENCE_WORK_MODE, TOKLIGENCE_OPENAI_API_KEY)
#    - Highest priority, overrides everything
#    - Set via: export TOKLIGENCE_XXX=value or in .env file
#    - Example: TOKLIGENCE_WORK_MODE=passthrough
#
# 2. Environment-specific gateway.ini files (config/dev|test|live/gateway.ini)
#    - Loaded based on 'environment' setting below or TOKLIGENCE_ENV env var
#    - Overrides base settings from this file
#    - Example: config/dev/gateway.ini overrides settings when environment=dev
#
# 3. This base setting.ini file (config/setting.ini)
#    - Base/default configuration shared across all environments
#    - Applied first, then overridden by environment-specific configs
#
# 4. Default values in code
#    - Lowest priority, used when no override is specified
#
# Example flow:
#   setting.ini has work_mode=auto
#   → dev/gateway.ini has work_mode=passthrough (overrides base)
#   → TOKLIGENCE_WORK_MODE=translation is set (overrides everything)
#   → Final value: translation
# ============================================================================
#
# Determines which config overlay to load (dev, test, live)
environment=dev
# Token Exchange base URL for API calls
base_url=http://localhost:8080
# Account email used when authenticating with the exchange
email=dev@example.com
# Friendly label shown in dashboards or CLI output - using "Tokligence Gateway Dev" from HEAD
display_name=Tokligence Gateway Dev
# Set true when this client should publish providers/services
enable_provider=false
# Marketplace name used when publishing a service (blank = skip publish)
publish_name=
# Optional model family hint (e.g., gpt-4, claude-3, llama-3)
model_family=
# Local token accounting price in USD per 1k tokens (float)
price_per_1k=0.5
# Separate log files for CLI and daemon (preferred). Use '-' for stdout only.
# Env overrides:
#   TOKLIGENCE_LOG_FILE_CLI, TOKLIGENCE_LOG_FILE_DAEMON (preferred)
#   TOKLIGENCE_LOG_FILE (fallback for both)
log_file_cli=logs/gateway-cli.log
log_file_daemon=logs/gatewayd.log
# Logging threshold: debug, info, warn, error
log_level=debug
# Disable auth for local development (override via TOKLIGENCE_AUTH_DISABLED)
auth_disabled=true

# Work Mode: controls passthrough vs translation behavior globally for all endpoints
# This is a critical setting that affects how the gateway handles requests:
#   - auto (default):        Smart routing - automatically choose passthrough or translation
#                            based on endpoint+model match (e.g., /v1/responses+gpt* = passthrough,
#                            /v1/responses+claude* = translation)
#   - passthrough:           Delegation-only mode - only allow direct passthrough/delegation
#                            to upstream providers, reject any translation requests
#   - translation:           Translation-only mode - only allow translation between API formats,
#                            reject any passthrough requests
# Override with: TOKLIGENCE_WORK_MODE=auto|passthrough|translation
work_mode=auto

# Database Connection Pool Configuration
# These settings control the connection pool for PostgreSQL/SQLite databases
# to handle high-concurrency workloads efficiently
#
# Override via environment variables:
#   TOKLIGENCE_DB_MAX_OPEN_CONNS, TOKLIGENCE_DB_MAX_IDLE_CONNS,
#   TOKLIGENCE_DB_CONN_MAX_LIFETIME, TOKLIGENCE_DB_CONN_MAX_IDLE_TIME
#
# Maximum number of open database connections (0 = unlimited, not recommended)
db_max_open_conns=1000
# Maximum number of idle connections to keep in the pool
db_max_idle_conns=100
# Maximum lifetime of a connection in minutes (default: 60)
db_conn_max_lifetime=60
# Maximum idle time of a connection in minutes (default: 10)
db_conn_max_idle_time=10

# Async Ledger Batch Writer Configuration
# For high-throughput scenarios (1M+ QPS), optimize these parameters:
#
# Override via environment variables:
#   TOKLIGENCE_LEDGER_ASYNC_BATCH_SIZE, TOKLIGENCE_LEDGER_ASYNC_FLUSH_MS,
#   TOKLIGENCE_LEDGER_ASYNC_BUFFER_SIZE, TOKLIGENCE_LEDGER_ASYNC_NUM_WORKERS
#
# Entries per batch before forcing a flush (default: 100, high QPS: 1000-10000)
ledger_async_batch_size=100
# Flush interval in milliseconds (default: 1000, high QPS: 100-500)
ledger_async_flush_ms=1000
# Channel buffer size (default: 10000, high QPS: 100000-1000000)
ledger_async_buffer_size=10000
# Number of parallel batch writer workers (default: 1, high QPS: 10-50)
ledger_async_num_workers=1
