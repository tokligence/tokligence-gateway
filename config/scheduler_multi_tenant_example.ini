# ============================================================================
# Multi-Tenant GPU Sharing Configuration Example
# ============================================================================
# Scenario: E-commerce company with shared GPU cluster
#
# Internal Departments (Day: High Priority):
#   - Department A: P0 (critical AI operations)
#   - Department B: P2 (analytics)
#   - Department C: P3 (recommendations)
#
# External Customers (Night: High Volume):
#   - Premium customers: P5
#   - Standard customers: P7
#   - Free tier: P9
#
# Schedule:
#   - Day (08:00-18:00): Internal priority, limited external
#   - Night (18:00-08:00): External priority, internal best-effort
# ============================================================================

[scheduler]
# Enable priority-based scheduler
scheduler_enabled = true

# Use hybrid policy (P0 strict, others WFQ)
scheduler_policy = hybrid

# Priority levels (10 levels: P0-P9)
scheduler_priority_levels = 10
scheduler_default_priority = 7  # Default to external standard

# Queue configuration
scheduler_max_queue_depth = 10000  # Large queue for external traffic spikes
scheduler_queue_timeout_sec = 60   # 1 minute max wait time

# ============================================================================
# Capacity Limits (Total GPU Cluster)
# ============================================================================
# Example: 8x A100 GPUs, ~500 tokens/sec per GPU = 4000 tokens/sec total

# Primary metric: Tokens per second
scheduler_max_tokens_per_sec = 4000

# Secondary metrics
scheduler_max_rps = 200              # Max 200 requests/sec
scheduler_max_concurrent = 100       # Max 100 concurrent requests
scheduler_max_context_length = 128000

# ============================================================================
# WFQ Weights Configuration
# ============================================================================
# Priority -> Weight mapping (higher = more bandwidth)
#
# P0 (Dept A - Critical): 256x weight
# P1 (Reserved):          128x
# P2 (Dept B - Analytics): 64x
# P3 (Dept C - Recs):      32x
# P4 (Reserved):           16x
# P5 (External Premium):   8x
# P6 (Reserved):           4x
# P7 (External Standard):  2x
# P8 (Reserved):           1x
# P9 (External Free):      1x
#
# Result: Department A gets 256x more bandwidth than free tier
scheduler_weights = 256,128,64,32,16,8,4,2,1,1

# ============================================================================
# Monitoring
# ============================================================================
# Stats logging interval (3 minutes)
scheduler_stats_interval_sec = 180

# ============================================================================
# API Key to Priority Mapping (TODO: Implement)
# ============================================================================
# Future: Map API keys to priorities automatically
#
# [scheduler_api_key_priority]
# dept_a_key_xxx = 0   # Department A -> P0
# dept_b_key_yyy = 2   # Department B -> P2
# dept_c_key_zzz = 3   # Department C -> P3
# premium_key_*  = 5   # Premium customers -> P5
# standard_key_* = 7   # Standard customers -> P7
# free_key_*     = 9   # Free tier -> P9

# ============================================================================
# Time-Based Quota Rules (TODO: Implement)
# ============================================================================
# Future: Adjust capacity limits based on time of day
#
# [scheduler_time_rules]
# # Daytime (08:00-18:00): Internal priority
# day_start = 08:00
# day_end = 18:00
# day_max_concurrent = 80        # 80% for internal
# day_reserved_priorities = 0,2,3  # Reserve for internal
#
# # Nighttime (18:00-08:00): External priority
# night_max_concurrent = 100     # All capacity available
# night_boost_priorities = 5,7,9  # Boost external priorities

# ============================================================================
# Per-Account Quotas (TODO: Implement)
# ============================================================================
# Future: Limit each department/customer independently
#
# [scheduler_account_quotas]
# dept_a_max_concurrent = 30
# dept_b_max_concurrent = 25
# dept_c_max_concurrent = 25
# external_premium_max_concurrent = 15
# external_standard_max_concurrent = 10
# external_free_max_concurrent = 5
